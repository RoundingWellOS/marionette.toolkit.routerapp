{"version":3,"sources":["marionette.toolkit.routerapp.js"],"names":[],"mappings":"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","file":"marionette.toolkit.routerapp.js","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('underscore'), require('backbone'), require('backbone.eventrouter'), require('backbone.marionette'), require('marionette.toolkit')) :\n  typeof define === 'function' && define.amd ? define(['underscore', 'backbone', 'backbone.eventrouter', 'backbone.marionette', 'marionette.toolkit'], factory) :\n  global.Marionette.Toolkit.RouterApp = factory(global._, global.Backbone, global.EventRouter, global.Marionette, global.Toolkit)\n}(this, function (_, Backbone, EventRouter, Marionette, Toolkit) { 'use strict';\n\n  var RouterApp = Marionette.Toolkit.RouterApp = Toolkit.App.extend({\n    constructor: function() {\n      this.configRoutes();\n\n      this.router = new this.EventRouter({\n        routeTriggers: this._routeTriggers\n      });\n\n      this.bindRouteEvents();\n\n      // if the app does not handle a given route, stop\n      this.listenTo(this.router, 'noMatch', this.stop);\n\n      Toolkit.App.apply(this, arguments);\n    },\n\n    // attaches parentRoutes and childRoutes\n    // for each route in the hash creates a routeTriggers hash\n    configRoutes: function() {\n      this._eventRoutes = _.extend({}, _.result(this, 'eventRoutes'));\n\n      this._routeTriggers = _.mapObject(this._eventRoutes, function(val, key, list) {\n        if(val.route) {\n          return val.route;\n        }\n        // if no route is given this key is not a routeTrigger\n        list[key] = null;\n      });\n    },\n\n    // backbone.eventrouter\n    // override with custom eventrouter\n    EventRouter: Backbone.EventRouter,\n\n    // handle route events\n    // accepts a hash of 'some:event' : 'actionFunction'\n    // listens to the router channel and calls the appropriate\n    // action via the routeAction handler\n    bindRouteEvents: function() {\n      var channel = this.router.getChannel();\n      _.each(this._eventRoutes, function(action, event) {\n        //handle eventRoute definitions\n        if(action.action) {\n          action = action.action;\n        }\n        this.listenTo(channel, event, _.partial(this.routeAction, event, action));\n      }, this);\n    },\n\n    // applys the route's action\n    // starts this routerapp if necessary\n    // triggers before and after events\n    routeAction: function(event, action) {\n      var eventArgs = _.tail(arguments, 2);\n\n      if(!this.isRunning()) {\n        this.start();\n      }\n\n      this.triggerMethod(`before:route`, event, eventArgs);\n\n      if(!_.isFunction(action)) {\n        action = this[action];\n      }\n\n      if(action) {\n        action.apply(this, eventArgs);\n      }\n\n      this.triggerMethod('route', event, eventArgs);\n    },\n\n    // handler that ensures one running app per type\n    startApp: function(appName, options) {\n      options = _.extend({}, _.result(this, 'routeOptions'), options);\n\n      this.stopCurrent();\n\n      var app = this.getChildApp(appName).start(options);\n\n      this.setCurrent(app);\n\n      return app;\n    },\n\n    setCurrent: function(app){\n      this._current = app;\n    },\n\n    getCurrent: function() {\n      return this._current;\n    },\n\n    stopCurrent: function() {\n      if(this._current) {\n        this._current.stop();\n      }\n      return this;\n    },\n\n    // takes an event and translates data into the applicable url fragment\n    translateEvent: function(event) {\n      var route = this.router.getDefaultRoute(event);\n\n      return this.router.translateRoute(route, _.drop(arguments, 0));\n    },\n\n    // takes an event and changes the URL without triggering or adding to the history\n    replaceRoute: function() {\n      var url = this.translateEvent.apply(this, arguments);\n\n      Backbone.history.navigate(url, { trigger: false, replace: true });\n    }\n  });\n\n\n  var routerapp = RouterApp;\n\n  return routerapp;\n\n}));\n"],"sourceRoot":"/source/"}